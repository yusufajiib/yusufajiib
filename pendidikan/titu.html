<!doctype html>
<html lang="id">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuis Sejarah Wali Songo</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    .quiz-container {
      min-height: 100%;
    }
    
    .option-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .option-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .option-card.selected {
      border-width: 3px;
    }
    
    .option-card.correct {
      background-color: #d1fae5;
      border-color: #10b981;
    }
    
    .option-card.incorrect {
      background-color: #fee2e2;
      border-color: #ef4444;
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .progress-bar {
      transition: width 0.3s ease;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body>
  <div id="app" class="quiz-container"></div>
  <script>
    const defaultConfig = {
      background_color: "#f0f9ff",
      card_color: "#ffffff",
      primary_color: "#3b82f6",
      text_color: "#1e293b",
      accent_color: "#10b981",
      font_family: "Inter",
      font_size: 16,
      judul_kuis: "Kuis Sejarah Wali Songo",
      deskripsi_kuis: "Uji pengetahuan Anda tentang sejarah para Wali Songo",
      tombol_mulai: "Mulai Kuis",
      tombol_submit: "Submit Jawaban"
    };

    let config = { ...defaultConfig };
    let currentRecordCount = 0;

    const quizData = [
      {
        id: 1,
        pertanyaan: "Maulana Malik Ibrahim dihormati oleh rakyat Majapahit dengan sebutan apa?",
        pilihan: ["Kakek Bantal", "Sunan Ampel", "Raden Paku", "Syekh Maulana"],
        jawaban: "Kakek Bantal"
      },
      {
        id: 2,
        pertanyaan: "Sumber sejarah menyebutkan bahwa Sunan Gresik kemungkinan berasal dari daerah mana?",
        pilihan: ["Baghdad", "Samarkand", "Mekah", "Damaskus"],
        jawaban: "Samarkand"
      },
      {
        id: 3,
        pertanyaan: "Pendekatan dakwah yang dilakukan Sunan Gresik melalui jalur perdagangan dan keramahan dikenal sebagai metode apa?",
        pilihan: ["Bil-Hikmah", "Bil-Qalam", "Bil-Lisan", "Bil-Hal"],
        jawaban: "Bil-Hikmah"
      },
      {
        id: 4,
        pertanyaan: "Peran Sunan Gresik di mata Raja Majapahit adalah sebagai apa, selain sebagai saudagar?",
        pilihan: ["Penasihat", "Tabib", "Panglima", "Menteri"],
        jawaban: "Tabib"
      },
      {
        id: 5,
        pertanyaan: "Karakter Sunan Gresik yang sangat menonjol dalam memuliakan orang miskin dan sakit adalah sifat apa?",
        pilihan: ["Dermawan", "Pemberani", "Bijaksana", "Tegas"],
        jawaban: "Dermawan"
      },
      {
        id: 6,
        pertanyaan: "Lokasi kompleks makam Sunan Gresik yang menjadi tujuan ziarah saat ini disebut apa?",
        pilihan: ["Maqbarah Ampel", "Maqbarah Gapuro Sukolilo", "Maqbarah Giri", "Maqbarah Drajat"],
        jawaban: "Maqbarah Gapuro Sukolilo"
      },
      {
        id: 7,
        pertanyaan: "Siapa nama ayah Sunan Ampel?",
        pilihan: ["Syekh Maulana Malik", "Syekh Ibrahim Asmarakandi", "Syekh Jumadil Kubra", "Syekh Ali Rahmatullah"],
        jawaban: "Syekh Ibrahim Asmarakandi"
      },
      {
        id: 8,
        pertanyaan: "Sebelum berdakwah di Jawa, Sunan Ampel tumbuh besar di kerajaan mana?",
        pilihan: ["Majapahit", "Demak", "Champa", "Malaka"],
        jawaban: "Champa"
      },
      {
        id: 9,
        pertanyaan: "Pesantren Ampel Denta terletak di wilayah kota mana saat ini?",
        pilihan: ["Gresik", "Surabaya", "Tuban", "Lamongan"],
        jawaban: "Surabaya"
      },
      {
        id: 10,
        pertanyaan: "Karakter Sunan Ampel yang paling kuat dalam menyusun strategi dakwah adalah?",
        pilihan: ["Visioner", "Pemberani", "Sabar", "Tegas"],
        jawaban: "Visioner"
      },
      {
        id: 11,
        pertanyaan: "Metode utama Sunan Ampel adalah melalui apa?",
        pilihan: ["Perdagangan", "Pendidikan", "Politik", "Kesenian"],
        jawaban: "Pendidikan"
      },
      {
        id: 12,
        pertanyaan: "Salah satu larangan dalam ajaran Moh Limo adalah Moh Maling, yang berarti tidak mau melakukan apa?",
        pilihan: ["Berbohong", "Pencurian", "Berjudi", "Mabuk"],
        jawaban: "Pencurian"
      },
      {
        id: 13,
        pertanyaan: "Masjid peninggalan Sunan Ampel yang masih digunakan hingga kini disebut apa?",
        pilihan: ["Masjid Demak", "Masjid Ampel", "Masjid Giri", "Masjid Agung"],
        jawaban: "Masjid Ampel"
      },
      {
        id: 14,
        pertanyaan: "Sunan Giri menikahi putri Sunan Ampel yang bernama siapa?",
        pilihan: ["Dewi Candrawati", "Dewi Murthasimah", "Dewi Sekardadu", "Dewi Retno"],
        jawaban: "Dewi Murthasimah"
      },
      {
        id: 15,
        pertanyaan: "Setelah dihanyutkan, Raden Paku ditemukan dan dibesarkan oleh siapa?",
        pilihan: ["Nyai Gede Pinatih", "Nyai Roro Kidul", "Nyai Ageng Serang", "Nyai Ontosoroh"],
        jawaban: "Nyai Gede Pinatih"
      },
      {
        id: 16,
        pertanyaan: "Setelah dewasa, Sunan Giri diutus oleh Sunan Ampel untuk berguru ke Tanah Suci bersama siapa?",
        pilihan: ["Sunan Bonang", "Sunan Drajat", "Sunan Kalijaga", "Sunan Kudus"],
        jawaban: "Sunan Bonang"
      },
      {
        id: 17,
        pertanyaan: "Metode dakwah Sunan Giri yang inovatif adalah dengan menciptakan apa yang bernapaskan Islam?",
        pilihan: ["Wayang", "Seni Dolanan", "Gamelan", "Tembang"],
        jawaban: "Seni Dolanan"
      },
      {
        id: 18,
        pertanyaan: "Pusat kekuasaan dan pendidikan yang didirikan Sunan Giri di atas bukit disebut apa?",
        pilihan: ["Giri Kedaton", "Ampel Denta", "Demak Bintoro", "Kudus Menara"],
        jawaban: "Giri Kedaton"
      },
      {
        id: 19,
        pertanyaan: "Kota tempat Sunan Giri menyebarkan Islam dan di mana Giri Kedaton berdiri adalah?",
        pilihan: ["Surabaya", "Gresik", "Tuban", "Lamongan"],
        jawaban: "Gresik"
      },
      {
        id: 20,
        pertanyaan: "Sunan Giri dijuluki apa karena beliau mampu menyatukan urusan agama dan pemerintahan?",
        pilihan: ["Prabu Satmata", "Ratu Adil", "Sultan Agung", "Pangeran Diponegoro"],
        jawaban: "Prabu Satmata"
      },
      {
        id: 21,
        pertanyaan: "Selain Cublak-Cublak Suweng, lagu dolanan karya Sunan Giri yang lain adalah?",
        pilihan: ["Gundul Pacul", "Jelungan", "Lir Ilir", "Tombo Ati"],
        jawaban: "Jelungan"
      },
      {
        id: 22,
        pertanyaan: "Pelajaran utama dari perjuangan Sunan Giri adalah kemampuan apa yang diwujudkan dalam penguasaan agama dan politik?",
        pilihan: ["Kepemimpinan", "Kesabaran", "Keberanian", "Kebijaksanaan"],
        jawaban: "Kepemimpinan"
      },
      {
        id: 23,
        pertanyaan: "Sunan Bonang dikenal dengan nama kecil apa?",
        pilihan: ["Raden Paku", "Makdum Ibrahim", "Raden Qosim", "Raden Mas Said"],
        jawaban: "Makdum Ibrahim"
      },
      {
        id: 24,
        pertanyaan: "Sunan Bonang memiliki keahlian dalam ilmu apa yang diperoleh dari berbagai guru?",
        pilihan: ["Fiqih", "Tasawuf", "Hadits", "Tafsir"],
        jawaban: "Tasawuf"
      },
      {
        id: 25,
        pertanyaan: "Meskipun berpusat di Tuban dan Lasem, nama Bonang diambil dari nama desa di daerah mana?",
        pilihan: ["Gresik", "Rembang", "Demak", "Kudus"],
        jawaban: "Rembang"
      },
      {
        id: 26,
        pertanyaan: "Salah satu strategi Sunan Bonang untuk menarik perhatian masyarakat adalah melalui alat musik apa?",
        pilihan: ["Rebana", "Gamelan", "Seruling", "Kendang"],
        jawaban: "Gamelan"
      },
      {
        id: 27,
        pertanyaan: "Tembang-tembang karya Sunan Bonang yang berisi nasihat keagamaan disebut apa?",
        pilihan: ["Tembang Macapat", "Tembang Dolanan", "Tembang Kinanthi", "Tembang Sinom"],
        jawaban: "Tembang Macapat"
      },
      {
        id: 28,
        pertanyaan: "Ajaran apa yang disampaikan Sunan Bonang untuk memenuhi kebutuhan spiritual masyarakat Jawa?",
        pilihan: ["Fiqih", "Tasawuf", "Akhlak", "Tauhid"],
        jawaban: "Tasawuf"
      },
      {
        id: 29,
        pertanyaan: "Salah satu kitab yang ditulis Sunan Bonang dan menjadi pedoman ajaran spiritual adalah?",
        pilihan: ["Suluk Wujil", "Serat Centhini", "Babad Tanah Jawi", "Kitab Primbon"],
        jawaban: "Suluk Wujil"
      },
      {
        id: 30,
        pertanyaan: "Sunan Drajat merupakan putra bungsu Sunan Ampel yang dikenal dengan nama apa?",
        pilihan: ["Raden Paku", "Raden Qosim", "Makdum Ibrahim", "Raden Mas Said"],
        jawaban: "Raden Qosim"
      },
      {
        id: 31,
        pertanyaan: "Sama seperti saudara-saudaranya, guru utama Sunan Drajat di masa mudanya adalah siapa?",
        pilihan: ["Sunan Gresik", "Sunan Ampel", "Sunan Giri", "Sunan Bonang"],
        jawaban: "Sunan Ampel"
      },
      {
        id: 32,
        pertanyaan: "Sunan Drajat berdakwah di daerah pantai utara Jawa, tepatnya di mana?",
        pilihan: ["Gresik", "Lamongan", "Tuban", "Rembang"],
        jawaban: "Lamongan"
      },
      {
        id: 33,
        pertanyaan: "Perjuangan Sunan Drajat yang paling terkenal adalah ajaran apa yang fokus pada 7 ajaran moral?",
        pilihan: ["Moh Limo", "Pepali Pitu", "Wejangan Luhur", "Piwulang Becik"],
        jawaban: "Pepali Pitu"
      },
      {
        id: 34,
        pertanyaan: "Pesan utama dari ajaran 'Wenehana mangan marang wong kang luwe' mengajarkan pentingnya apa?",
        pilihan: ["Kejujuran", "Kepedulian Sosial", "Kesabaran", "Keikhlasan"],
        jawaban: "Kepedulian Sosial"
      }
    ];

    let currentQuestion = 0;
    let userAnswers = [];
    let quizStarted = false;
    let quizFinished = false;
    let isSubmitting = false;

    const dataHandler = {
      onDataChanged(data) {
        currentRecordCount = data.length;
        if (quizFinished) {
          renderResults();
        }
      }
    };

    async function initApp() {
      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error("Gagal menginisialisasi Data SDK");
      }
      
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (newConfig) => {
            config = { ...newConfig };
            render();
          },
          mapToCapabilities: (cfg) => ({
            recolorables: [
              {
                get: () => cfg.background_color || defaultConfig.background_color,
                set: (value) => {
                  cfg.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => cfg.card_color || defaultConfig.card_color,
                set: (value) => {
                  cfg.card_color = value;
                  window.elementSdk.setConfig({ card_color: value });
                }
              },
              {
                get: () => cfg.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  cfg.primary_color = value;
                  window.elementSdk.setConfig({ primary_color: value });
                }
              },
              {
                get: () => cfg.text_color || defaultConfig.text_color,
                set: (value) => {
                  cfg.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => cfg.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  cfg.accent_color = value;
                  window.elementSdk.setConfig({ accent_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => cfg.font_family || defaultConfig.font_family,
              set: (value) => {
                cfg.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => cfg.font_size || defaultConfig.font_size,
              set: (value) => {
                cfg.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (cfg) => new Map([
            ["judul_kuis", cfg.judul_kuis || defaultConfig.judul_kuis],
            ["deskripsi_kuis", cfg.deskripsi_kuis || defaultConfig.deskripsi_kuis],
            ["tombol_mulai", cfg.tombol_mulai || defaultConfig.tombol_mulai],
            ["tombol_submit", cfg.tombol_submit || defaultConfig.tombol_submit]
          ])
        });
        
        if (window.elementSdk.config) {
          config = { ...window.elementSdk.config };
        }
      }
      
      render();
    }

    function render() {
      const app = document.getElementById('app');
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const bgColor = config.background_color || defaultConfig.background_color;
      const cardColor = config.card_color || defaultConfig.card_color;
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      
      document.body.style.backgroundColor = bgColor;
      document.body.style.fontFamily = `${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif`;
      
      if (!quizStarted) {
        app.innerHTML = `
          <div class="flex items-center justify-center min-h-full p-6">
            <div class="w-full max-w-2xl fade-in" style="background-color: ${cardColor}; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); padding: 48px;">
              <div class="text-center">
                <div style="width: 80px; height: 80px; background-color: ${primaryColor}; border-radius: 50%; margin: 0 auto 24px; display: flex; align-items: center; justify-content: center;">
                  <span style="font-size: ${baseSize * 2.5}px;">üìö</span>
                </div>
                <h1 style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${textColor}; margin-bottom: 16px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  ${config.judul_kuis || defaultConfig.judul_kuis}
                </h1>
                <p style="font-size: ${baseSize * 1.125}px; color: ${textColor}; opacity: 0.7; margin-bottom: 32px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  ${config.deskripsi_kuis || defaultConfig.deskripsi_kuis}
                </p>
                <div style="background-color: ${bgColor}; border-radius: 12px; padding: 24px; margin-bottom: 32px;">
                  <div style="display: flex; justify-content: space-around; text-align: center;">
                    <div>
                      <div style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${primaryColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">${quizData.length}</div>
                      <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.6; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">Pertanyaan</div>
                    </div>
                    <div>
                      <div style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${accentColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">‚è±Ô∏è</div>
                      <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.6; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">Tanpa Batas</div>
                    </div>
                  </div>
                </div>
                <button onclick="startQuiz()" style="background-color: ${primaryColor}; color: white; font-size: ${baseSize * 1.125}px; font-weight: 600; padding: 16px 48px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.3s ease; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 24px rgba(59, 130, 246, 0.3)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none'">
                  ${config.tombol_mulai || defaultConfig.tombol_mulai}
                </button>
              </div>
            </div>
          </div>
        `;
      } else if (!quizFinished) {
        renderQuestion();
      } else {
        renderResults();
      }
    }

    function renderQuestion() {
      const app = document.getElementById('app');
      const question = quizData[currentQuestion];
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const cardColor = config.card_color || defaultConfig.card_color;
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      const progress = ((currentQuestion + 1) / quizData.length) * 100;
      
      app.innerHTML = `
        <div class="min-h-full p-6">
          <div class="max-w-3xl mx-auto">
            <div class="mb-6">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <span style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.7; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  Pertanyaan ${currentQuestion + 1} dari ${quizData.length}
                </span>
                <span style="font-size: ${baseSize * 0.875}px; font-weight: 600; color: ${primaryColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  ${Math.round(progress)}%
                </span>
              </div>
              <div style="width: 100%; height: 8px; background-color: rgba(59, 130, 246, 0.2); border-radius: 999px; overflow: hidden;">
                <div class="progress-bar" style="width: ${progress}%; height: 100%; background-color: ${primaryColor}; border-radius: 999px;"></div>
              </div>
            </div>
            
            <div class="fade-in" style="background-color: ${cardColor}; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); padding: 40px; margin-bottom: 24px;">
              <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${textColor}; margin-bottom: 32px; line-height: 1.4; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                ${question.pertanyaan}
              </h2>
              
              <div id="options-container" style="display: grid; gap: 16px;">
                ${question.pilihan.map((pilihan, index) => `
                  <div class="option-card" onclick="selectOption(${index})" style="background-color: ${cardColor}; border: 2px solid rgba(59, 130, 246, 0.2); border-radius: 12px; padding: 20px; cursor: pointer; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    <div style="display: flex; align-items: center; gap: 16px;">
                      <div style="width: 32px; height: 32px; border-radius: 50%; background-color: ${primaryColor}; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: ${baseSize * 0.875}px; flex-shrink: 0;">
                        ${String.fromCharCode(65 + index)}
                      </div>
                      <span style="font-size: ${baseSize}px; color: ${textColor}; font-weight: 500;">
                        ${pilihan}
                      </span>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <button onclick="previousQuestion()" ${currentQuestion === 0 ? 'disabled' : ''} style="background-color: ${cardColor}; color: ${textColor}; font-size: ${baseSize}px; font-weight: 600; padding: 12px 24px; border-radius: 12px; border: 2px solid rgba(59, 130, 246, 0.2); cursor: ${currentQuestion === 0 ? 'not-allowed' : 'pointer'}; opacity: ${currentQuestion === 0 ? '0.5' : '1'}; transition: all 0.3s ease; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                ‚Üê Sebelumnya
              </button>
              
              ${currentQuestion === quizData.length - 1 ? `
                <button id="submit-btn" onclick="submitQuiz()" style="background-color: ${accentColor}; color: white; font-size: ${baseSize}px; font-weight: 600; padding: 12px 32px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.3s ease; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                  ${config.tombol_submit || defaultConfig.tombol_submit}
                </button>
              ` : `
                <button onclick="nextQuestion()" style="background-color: ${primaryColor}; color: white; font-size: ${baseSize}px; font-weight: 600; padding: 12px 32px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.3s ease; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                  Selanjutnya ‚Üí
                </button>
              `}
            </div>
          </div>
        </div>
      `;
      
      if (userAnswers[currentQuestion] !== undefined) {
        const selectedCard = document.querySelectorAll('.option-card')[userAnswers[currentQuestion]];
        if (selectedCard) {
          selectedCard.classList.add('selected');
          selectedCard.style.borderColor = primaryColor;
          selectedCard.style.backgroundColor = `${primaryColor}15`;
        }
      }
    }

    function renderResults() {
      const app = document.getElementById('app');
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const cardColor = config.card_color || defaultConfig.card_color;
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      
      let correctCount = 0;
      const results = quizData.map((q, index) => {
        const userAnswer = q.pilihan[userAnswers[index]];
        const isCorrect = userAnswer === q.jawaban;
        if (isCorrect) correctCount++;
        return { ...q, userAnswer, isCorrect };
      });
      
      const score = Math.round((correctCount / quizData.length) * 100);
      const incorrectCount = quizData.length - correctCount;
      
      app.innerHTML = `
        <div class="min-h-full p-6">
          <div class="max-w-4xl mx-auto">
            <div class="fade-in" style="background-color: ${cardColor}; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); padding: 48px; margin-bottom: 24px; text-align: center;">
              <div style="width: 100px; height: 100px; background: linear-gradient(135deg, ${primaryColor}, ${accentColor}); border-radius: 50%; margin: 0 auto 24px; display: flex; align-items: center; justify-content: center;">
                <span style="font-size: ${baseSize * 3}px;">üéâ</span>
              </div>
              
              <h1 style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${textColor}; margin-bottom: 16px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                Kuis Selesai!
              </h1>
              
              <p style="font-size: ${baseSize * 1.125}px; color: ${textColor}; opacity: 0.7; margin-bottom: 32px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                Berikut adalah hasil kuis Anda
              </p>
              
              <div style="display: inline-block; background: linear-gradient(135deg, ${primaryColor}, ${accentColor}); border-radius: 16px; padding: 32px 48px; margin-bottom: 32px;">
                <div style="font-size: ${baseSize * 4}px; font-weight: 700; color: white; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  ${score}
                </div>
                <div style="font-size: ${baseSize * 1.125}px; color: white; opacity: 0.9; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  Nilai Akhir
                </div>
              </div>
              
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 32px;">
                <div style="background-color: rgba(16, 185, 129, 0.1); border-radius: 12px; padding: 20px;">
                  <div style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${accentColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    ${correctCount}
                  </div>
                  <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.7; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    Benar ‚úì
                  </div>
                </div>
                
                <div style="background-color: rgba(239, 68, 68, 0.1); border-radius: 12px; padding: 20px;">
                  <div style="font-size: ${baseSize * 2}px; font-weight: 700; color: #ef4444; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    ${incorrectCount}
                  </div>
                  <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.7; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    Salah ‚úó
                  </div>
                </div>
                
                <div style="background-color: rgba(59, 130, 246, 0.1); border-radius: 12px; padding: 20px;">
                  <div style="font-size: ${baseSize * 2}px; font-weight: 700; color: ${primaryColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    ${quizData.length}
                  </div>
                  <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.7; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    Total Soal
                  </div>
                </div>
              </div>
              
              <div style="margin-bottom: 24px;">
                <label style="display: block; font-size: ${baseSize * 0.875}px; font-weight: 600; color: ${textColor}; margin-bottom: 8px; text-align: left; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                  Nama Peserta (Opsional)
                </label>
                <input type="text" id="participant-name" placeholder="Masukkan nama Anda" style="width: 100%; padding: 12px 16px; border: 2px solid rgba(59, 130, 246, 0.2); border-radius: 8px; font-size: ${baseSize}px; color: ${textColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;" />
              </div>
              
              <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                <button id="save-btn" onclick="saveResult()" style="background-color: ${accentColor}; color: white; font-size: ${baseSize}px; font-weight: 600; padding: 12px 32px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.3s ease; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                  üíæ Simpan Hasil
                </button>
                <button onclick="restartQuiz()" style="background-color: ${primaryColor}; color: white; font-size: ${baseSize}px; font-weight: 600; padding: 12px 32px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.3s ease; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                  üîÑ Ulangi Kuis
                </button>
              </div>
            </div>
            
            <div style="background-color: ${cardColor}; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); padding: 32px;">
              <h2 style="font-size: ${baseSize * 1.5}px; font-weight: 700; color: ${textColor}; margin-bottom: 24px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                üìã Pembahasan Jawaban
              </h2>
              
              <div style="display: grid; gap: 16px;">
                ${results.map((result, index) => `
                  <div style="border: 2px solid ${result.isCorrect ? accentColor : '#ef4444'}; border-radius: 12px; padding: 20px; background-color: ${result.isCorrect ? 'rgba(16, 185, 129, 0.05)' : 'rgba(239, 68, 68, 0.05)'};">
                    <div style="display: flex; align-items: start; gap: 12px; margin-bottom: 12px;">
                      <span style="font-size: ${baseSize * 1.5}px;">
                        ${result.isCorrect ? '‚úÖ' : '‚ùå'}
                      </span>
                      <div style="flex: 1;">
                        <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; opacity: 0.6; margin-bottom: 4px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                          Soal ${index + 1}
                        </div>
                        <div style="font-size: ${baseSize}px; font-weight: 600; color: ${textColor}; margin-bottom: 12px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                          ${result.pertanyaan}
                        </div>
                        <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                          <span style="opacity: 0.7;">Jawaban Anda:</span>
                          <span style="font-weight: 600; color: ${result.isCorrect ? accentColor : '#ef4444'};">
                            ${result.userAnswer || 'Tidak dijawab'}
                          </span>
                        </div>
                        ${!result.isCorrect ? `
                          <div style="font-size: ${baseSize * 0.875}px; color: ${textColor}; margin-top: 4px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                            <span style="opacity: 0.7;">Jawaban Benar:</span>
                            <span style="font-weight: 600; color: ${accentColor};">
                              ${result.jawaban}
                            </span>
                          </div>
                        ` : ''}
                      </div>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function startQuiz() {
      quizStarted = true;
      currentQuestion = 0;
      userAnswers = [];
      quizFinished = false;
      render();
    }

    function selectOption(index) {
      userAnswers[currentQuestion] = index;
      const cards = document.querySelectorAll('.option-card');
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      
      cards.forEach((card, i) => {
        card.classList.remove('selected');
        card.style.borderColor = 'rgba(59, 130, 246, 0.2)';
        card.style.backgroundColor = config.card_color || defaultConfig.card_color;
        
        if (i === index) {
          card.classList.add('selected');
          card.style.borderColor = primaryColor;
          card.style.backgroundColor = `${primaryColor}15`;
        }
      });
    }

    function nextQuestion() {
      if (currentQuestion < quizData.length - 1) {
        currentQuestion++;
        renderQuestion();
      }
    }

    function previousQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        renderQuestion();
      }
    }

    async function submitQuiz() {
      if (isSubmitting) return;
      
      const unanswered = userAnswers.filter(a => a === undefined).length;
      if (unanswered > 0) {
        const confirmDiv = document.createElement('div');
        confirmDiv.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background-color: ${config.card_color || defaultConfig.card_color};
          padding: 32px;
          border-radius: 16px;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
          z-index: 1000;
          max-width: 400px;
          text-align: center;
        `;
        
        const baseSize = config.font_size || defaultConfig.font_size;
        const customFont = config.font_family || defaultConfig.font_family;
        const textColor = config.text_color || defaultConfig.text_color;
        const primaryColor = config.primary_color || defaultConfig.primary_color;
        
        confirmDiv.innerHTML = `
          <div style="font-size: ${baseSize * 3}px; margin-bottom: 16px;">‚ö†Ô∏è</div>
          <h3 style="font-size: ${baseSize * 1.25}px; font-weight: 700; color: ${textColor}; margin-bottom: 12px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
            Ada ${unanswered} soal yang belum dijawab
          </h3>
          <p style="font-size: ${baseSize}px; color: ${textColor}; opacity: 0.7; margin-bottom: 24px; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
            Apakah Anda yakin ingin submit?
          </p>
          <div style="display: flex; gap: 12px; justify-content: center;">
            <button onclick="this.parentElement.parentElement.remove()" style="background-color: rgba(59, 130, 246, 0.1); color: ${textColor}; font-size: ${baseSize * 0.875}px; font-weight: 600; padding: 10px 24px; border-radius: 8px; border: none; cursor: pointer; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
              Batal
            </button>
            <button onclick="confirmSubmit(); this.parentElement.parentElement.remove();" style="background-color: ${primaryColor}; color: white; font-size: ${baseSize * 0.875}px; font-weight: 600; padding: 10px 24px; border-radius: 8px; border: none; cursor: pointer; font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
              Ya, Submit
            </button>
          </div>
        `;
        
        const backdrop = document.createElement('div');
        backdrop.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          z-index: 999;
        `;
        backdrop.onclick = () => {
          backdrop.remove();
          confirmDiv.remove();
        };
        
        document.body.appendChild(backdrop);
        document.body.appendChild(confirmDiv);
        return;
      }
      
      confirmSubmit();
    }

    function confirmSubmit() {
      quizFinished = true;
      render();
    }

    async function saveResult() {
      if (isSubmitting) return;
      
      if (currentRecordCount >= 999) {
        showMessage("Batas maksimum 999 hasil telah tercapai. Silakan hapus beberapa hasil terlebih dahulu.", "error");
        return;
      }
      
      isSubmitting = true;
      const saveBtn = document.getElementById('save-btn');
      if (saveBtn) {
        saveBtn.disabled = true;
        saveBtn.textContent = 'Menyimpan...';
        saveBtn.style.opacity = '0.6';
      }
      
      const participantName = document.getElementById('participant-name').value.trim() || 'Anonim';
      
      let correctCount = 0;
      quizData.forEach((q, index) => {
        const userAnswer = q.pilihan[userAnswers[index]];
        if (userAnswer === q.jawaban) correctCount++;
      });
      
      const score = Math.round((correctCount / quizData.length) * 100);
      const incorrectCount = quizData.length - correctCount;
      
      const result = await window.dataSdk.create({
        nama_peserta: participantName,
        nilai: score,
        benar: correctCount,
        salah: incorrectCount,
        tanggal: new Date().toISOString()
      });
      
      isSubmitting = false;
      
      if (result.isOk) {
        showMessage("‚úÖ Hasil kuis berhasil disimpan!", "success");
        if (saveBtn) {
          saveBtn.textContent = '‚úì Tersimpan';
          saveBtn.style.backgroundColor = config.accent_color || defaultConfig.accent_color;
        }
      } else {
        showMessage("‚ùå Gagal menyimpan hasil. Silakan coba lagi.", "error");
        if (saveBtn) {
          saveBtn.disabled = false;
          saveBtn.textContent = 'üíæ Simpan Hasil';
          saveBtn.style.opacity = '1';
        }
      }
    }

    function showMessage(message, type) {
      const toast = document.createElement('div');
      const bgColor = type === 'success' ? (config.accent_color || defaultConfig.accent_color) : '#ef4444';
      const baseSize = config.font_size || defaultConfig.font_size;
      const customFont = config.font_family || defaultConfig.font_family;
      
      toast.style.cssText = `
        position: fixed;
        top: 24px;
        right: 24px;
        background-color: ${bgColor};
        color: white;
        padding: 16px 24px;
        border-radius: 12px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        font-size: ${baseSize}px;
        font-weight: 600;
        animation: slideIn 0.3s ease;
        font-family: ${customFont}, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      `;
      
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    function restartQuiz() {
      quizStarted = false;
      currentQuestion = 0;
      userAnswers = [];
      quizFinished = false;
      isSubmitting = false;
      render();
    }

    document.addEventListener('DOMContentLoaded', initApp);
  </script>
  <style>
    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(400px);
        opacity: 0;
      }
    }
  </style>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a3889d273690f2',t:'MTc2MjQyMTAyMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
