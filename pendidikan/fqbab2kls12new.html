<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Pembelajaran Interaktif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        
        .celebration {
            animation: bounce 0.6s ease-in-out;
        }
        
        .sad-shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            80% { transform: translateY(-10px); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .correct-answer {
            animation: correctZoom 0.8s ease-in-out;
            background: linear-gradient(135deg, #10b981, #059669) !important;
            color: white !important;
            border-color: #059669 !important;
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }
        
        .wrong-answer {
            animation: wrongShake 0.5s ease-in-out;
            background: linear-gradient(135deg, #ef4444, #dc2626) !important;
            color: white !important;
            border-color: #dc2626 !important;
        }
        
        .correct-text-answer {
            animation: correctZoom 0.8s ease-in-out;
            background: linear-gradient(135deg, #10b981, #059669) !important;
            color: white !important;
            border-color: #059669 !important;
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }
        
        .wrong-text-answer {
            animation: wrongShake 0.5s ease-in-out;
            background: linear-gradient(135deg, #ef4444, #dc2626) !important;
            color: white !important;
            border-color: #dc2626 !important;
        }
        
        @keyframes correctZoom {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }
        
        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
            20%, 40%, 60%, 80% { transform: translateX(8px); }
        }
        
        .answer-reveal {
            margin-top: 1rem;
            padding: 1rem;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border-radius: 0.75rem;
            animation: slideDown 0.6s ease-out;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
        
        @keyframes slideDown {
            from { 
                opacity: 0; 
                transform: translateY(-20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <div class="bg-white shadow-lg">
        <div class="max-w-4xl mx-auto px-6 py-4">
            <h1 class="text-3xl font-bold text-indigo-800 text-center">üéì Quiz Pembelajaran Interaktif</h1>
        </div>
    </div>

    <!-- Main Container -->
    <div class="max-w-4xl mx-auto px-6 py-8">
        <!-- Student Info Form -->
        <div id="studentForm" class="bg-white rounded-xl shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">üìù Data Siswa</h2>
            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                    <input type="text" id="studentName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="Masukkan nama Anda">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                    <select id="studentClass" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        <option value="">Pilih Kelas</option>
                        <option value="X IPA 1">X IPA 1</option>
                        <option value="X IPA 2">X IPA 2</option>
                        <option value="X IPS 1">X IPS 1</option>
                        <option value="X IPS 2">X IPS 2</option>
                        <option value="XI IPA 1">XI IPA 1</option>
                        <option value="XI IPA 2">XI IPA 2</option>
                        <option value="XI IPS 1">XI IPS 1</option>
                        <option value="XI IPS 2">XI IPS 2</option>
                        <option value="XII IPA 1">XII IPA 1</option>
                        <option value="XII IPA 2">XII IPA 2</option>
                        <option value="XII IPS 1">XII IPS 1</option>
                        <option value="XII IPS 2">XII IPS 2</option>
                    </select>
                </div>
            </div>
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Mata Pelajaran</label>
                    <select id="subjectName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" onchange="updateChapters()">
                        <option value="">Pilih Mata Pelajaran</option>
                        <option value="Fisika">Fisika</option>
                        <option value="Kimia">Kimia</option>
                        <option value="Biologi">Biologi</option>
                        <option value="Matematika">Matematika</option>
                        <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                        <option value="Bahasa Inggris">Bahasa Inggris</option>
                        <option value="Sejarah">Sejarah</option>
                        <option value="Geografi">Geografi</option>
                        <option value="Ekonomi">Ekonomi</option>
                        <option value="Sosiologi">Sosiologi</option>
                        <option value="Quran Hadist">Quran Hadist</option>
                        <option value="Fikih">Fikih</option>
                        <option value="Akidah Akhlaq">Akidah Akhlaq</option>
                        <option value="Sejarah Kebudayaan Islam">Sejarah Kebudayaan Islam</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Bab Materi</label>
                    <select id="chapterName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" disabled>
                        <option value="">Pilih mata pelajaran terlebih dahulu</option>
                    </select>
                </div>
            </div>
            <button onclick="startQuiz()" class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 transform hover:scale-105">
                üöÄ Mulai Quiz
            </button>
        </div>

        <!-- Quiz Container -->
        <div id="quizContainer" class="hidden">
            <!-- Progress Bar -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Progress Quiz</span>
                    <span id="progressText" class="text-sm font-medium text-indigo-600">1 / 50</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div id="progressBar" class="bg-indigo-600 h-3 rounded-full transition-all duration-300" style="width: 2%"></div>
                </div>
            </div>

            <!-- Question Card -->
            <div id="questionCard" class="bg-white rounded-xl shadow-lg p-8">
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <span id="questionType" class="px-4 py-2 bg-indigo-100 text-indigo-800 rounded-full text-sm font-medium">Pilihan Ganda</span>
                        <span id="questionNumber" class="text-gray-500 font-medium">Soal 1</span>
                    </div>
                    <h3 id="questionText" class="text-xl font-semibold text-gray-800 leading-relaxed"></h3>
                </div>

                <!-- Answer Options -->
                <div id="answerOptions" class="space-y-3"></div>

                <!-- Submit Button -->
                <button id="submitAnswer" onclick="checkAnswer()" class="w-full mt-6 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                    ‚úÖ Submit Jawaban
                </button>
            </div>

            <!-- Feedback Modal -->
            <div id="feedbackModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-xl p-8 max-w-md mx-4 text-center">
                    <div id="feedbackIcon" class="text-6xl mb-4"></div>
                    <h3 id="feedbackTitle" class="text-2xl font-bold mb-2"></h3>
                    <p id="feedbackMessage" class="text-gray-600 mb-6"></p>
                    <button onclick="nextQuestion()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300">
                        Lanjut
                    </button>
                </div>
            </div>
        </div>

        <!-- Results -->
        <div id="resultsContainer" class="hidden bg-white rounded-xl shadow-lg p-8 text-center">
            <div class="text-6xl mb-4">üéâ</div>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Quiz Selesai!</h2>
            <div class="bg-indigo-50 rounded-lg p-6 mb-6">
                <div class="text-4xl font-bold text-indigo-600 mb-2" id="finalScore">0/50</div>
                <p class="text-gray-600">Skor Akhir</p>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-green-50 rounded-lg p-4">
                    <div class="text-2xl font-bold text-green-600" id="correctCount">0</div>
                    <p class="text-green-700">Benar</p>
                </div>
                <div class="bg-red-50 rounded-lg p-4">
                    <div class="text-2xl font-bold text-red-600" id="wrongCount">0</div>
                    <p class="text-red-700">Salah</p>
                </div>
            </div>
            <button onclick="submitToGoogleSheets()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg transition duration-300 mr-4">
                üìä Kirim ke Google Sheets
            </button>
            <button onclick="restartQuiz()" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-8 rounded-lg transition duration-300">
                üîÑ Ulangi Quiz
            </button>
        </div>
    </div>

    <script>
        // Quiz Data
        const quizData = [
            {
                type: "Pilihan Ganda",
                question: "Al-Qur'an mendapatkan kedudukan sebagai sumber hukum Islam yang paling tinggi dibandingkan dengan sumber-sumber hukum lainnya karena .....",
                options: [
                    "merupakan kitab terakhir",
                    "diturunkan lebih awal dari Hadis",
                    "diturunkan menggunakan bahasa Arab",
                    "merupakan sumber hukum paling tinggi dan tidak boleh bertentangan dengannya",
                    "menjelaskan semua hukum secara rinci"
                ],
                correct: 3,
                explanation: "Al-Qur'an adalah sumber hukum Islam yang paling tinggi dan semua sumber hukum lainnya tidak boleh bertentangan dengannya."
            },
            {
                type: "Pilihan Ganda",
                question: "Berikut ini yang bukan syarat seorang mujtahid adalah",
                options: [
                    "menguasai ilmu ushul fiqih",
                    "memahami maqashid syariah",
                    "menguasai ilmu tafsir",
                    "menguasai bahasa Arab",
                    "mengetahui ijma' sebelumnya"
                ],
                correct: 2,
                explanation: "Menguasai ilmu tafsir bukan syarat utama seorang mujtahid, meskipun penting untuk dipahami."
            },
            {
                type: "Pilihan Ganda",
                question: "Ijma' tidak dapat dilakukan jika...",
                options: [
                    "para mujtahid hidup di satu masa",
                    "semua mujtahid menyetujui hukum secara lisan",
                    "disepakati oleh seluruh mujtahid di dunia",
                    "disepakati hanya oleh sekelompok mujtahid tertentu di wilayah tertentu",
                    "semua mujtahid mengetahui masalah yang dimakan"
                ],
                correct: 3,
                explanation: "Ijma' harus disepakati oleh seluruh mujtahid, bukan hanya sekelompok mujtahid tertentu di wilayah tertentu."
            },
            {
                type: "Pilihan Ganda",
                question: "Salah satu contoh qiyas aulawi adalah...",
                options: [
                    "mengqiyaskan emas dengan perak",
                    "mengqiyaskan makan dengan minum",
                    "larangan memukul orang tua karena berkata 'uh' saja dilarang",
                    "mengqiyaskan pembunuhan dengan benda berat pada benda tajam",
                    "zakat profesi dengan zakat perdagangan"
                ],
                correct: 2,
                explanation: "Qiyas aulawi adalah analogi yang hukumnya lebih kuat dari asalnya, seperti larangan memukul orang tua yang lebih kuat dari larangan berkata 'uh'."
            },
            {
                type: "Pilihan Ganda",
                question: "Yang disebutkan bersamaan dengan sesuatu yang lain disebut...",
                options: [
                    "maslahah mursalah",
                    "dalalat al-iqtiran",
                    "istihsan",
                    "istihsab",
                    "syar'u man qablana"
                ],
                correct: 1,
                explanation: "Dalalat al-iqtiran adalah dalil yang menunjukkan sesuatu yang disebutkan bersamaan dengan sesuatu yang lain."
            },
            {
                type: "Pilihan Ganda",
                question: "Menurut Imam Syafi'i hukum umrah sama dengan haji, yaitu wajib. Wajib umrah ini ditetapkan dengan kaidah....",
                options: [
                    "istishab",
                    "istihsan",
                    "masalih mursalah",
                    "syar'u man qablana",
                    "dalalat iqtiran"
                ],
                correct: 4,
                explanation: "Imam Syafi'i menetapkan wajib umrah dengan kaidah dalalat iqtiran karena umrah disebutkan bersamaan dengan haji dalam Al-Qur'an."
            },
            {
                type: "Pilihan Ganda",
                question: "Menurut Imam... boleh berpegang kepada al-maslahah al-mursalah apabila sesuai dengan dalil kulli atau dalil juz'i dari syara'...",
                options: [
                    "Syaukani",
                    "Malik",
                    "Nawawi",
                    "Syafi'i",
                    "Hanbali"
                ],
                correct: 1,
                explanation: "Imam Malik membolehkan berpegang kepada al-maslahah al-mursalah apabila sesuai dengan dalil kulli atau dalil juz'i dari syara'."
            },
            {
                type: "Pilihan Ganda",
                question: "Mazhab yang menolak istishab sebagai sumber hukum adalah....",
                options: [
                    "Syafi'iyah",
                    "Hanafiyah",
                    "Hambaliyah",
                    "Malikiyah",
                    "Zhahiriyah"
                ],
                correct: 4,
                explanation: "Mazhab Zhahiriyah menolak istishab sebagai sumber hukum karena mereka hanya berpegang pada zahir nash."
            },
            {
                type: "Pilihan Ganda",
                question: "Perkataan sahabat yang tidak mendapatkan tantangan (reaksi) dari sahabat lain merupakan....",
                options: [
                    "hujjah bagi umat Islam",
                    "sekadar kabar dari sahabat",
                    "sumber hukum bagi umat Islam",
                    "dalil bagi sebuah perbuatan",
                    "kreativitas dari para sahabat"
                ],
                correct: 0,
                explanation: "Perkataan sahabat yang tidak mendapat tantangan dari sahabat lain dianggap sebagai hujjah (dalil) bagi umat Islam."
            },
            {
                type: "Pilihan Ganda",
                question: "Masalah yang lahirnya boleh (mubah), tetapi dapat membuka jalan untuk melakukan perbuatan yang dilarang oleh ulama ushul fikih disebut..",
                options: [
                    "mazhab shahabi",
                    "dzari'ah",
                    "dalalat al-iqtiran",
                    "al-'urf",
                    "syar'u man qablana"
                ],
                correct: 1,
                explanation: "Dzari'ah adalah masalah yang pada dasarnya mubah tetapi dapat membuka jalan kepada perbuatan yang dilarang."
            },
            {
                type: "Pilihan Ganda",
                question: "Ulama berikut ini yang menyatakan bahwa dalalat al-iqtiran dapat dijadikan sebagai hujjah adalah....",
                options: [
                    "Ibnu Hibban",
                    "Ibnu Taimiyah",
                    "Ibnu Nashar",
                    "Muhammad Iqbal",
                    "Yusuf al-Qardhawi"
                ],
                correct: 1,
                explanation: "Ibnu Taimiyah adalah ulama yang menyatakan bahwa dalalat al-iqtiran dapat dijadikan sebagai hujjah dalam penetapan hukum."
            },
            {
                type: "Pilihan Ganda",
                question: "Sesuatu yang menjadi adat kebiasaan kaum muslimin dan tidak bertentangan dengan dalil syara', tidak menghalalkan perkara haram, dan tidak membatalkan perkara wajib merupakan pengertian dari....",
                options: [
                    "ijtihad",
                    "istihsan",
                    "'urf",
                    "syar'u man qablana",
                    "istishab"
                ],
                correct: 2,
                explanation: "'Urf adalah adat kebiasaan kaum muslimin yang tidak bertentangan dengan dalil syara', tidak menghalalkan yang haram, dan tidak membatalkan yang wajib."
            },
            {
                type: "Pilihan Ganda",
                question: "Bahwa dengan nash-nash dan qiyas yang dibenarkan syariat senantiasa memperhatikan kemaslahatan umat manusia. Tidak ada satu pun kemaslahatan manusia yang tidak diperhatikan oleh syariat melalui petunjuknya, adalah salah satu alasan ditolaknya maslahah mursalah sebagai sumber hukum oleh...",
                options: [
                    "Syafiyah",
                    "Hanafiyah",
                    "Malikiyah",
                    "jumhur ulama",
                    "Hanabilah"
                ],
                correct: 0,
                explanation: "Mazhab Syafi'iyah menolak maslahah mursalah karena menganggap bahwa nash dan qiyas sudah mencakup semua kemaslahatan manusia."
            },
            {
                type: "Pilihan Ganda",
                question: "Imam Syafi'i menolak berhujjah dengan istihsan, sebab berhujjah dengan istihsan berarti menetapkan hukum berdasarkan ....",
                options: [
                    "al-Qur'an",
                    "qiyas",
                    "sunah",
                    "hawa nafsu",
                    "ijma'"
                ],
                correct: 3,
                explanation: "Imam Syafi'i menolak istihsan karena menganggap bahwa berhujjah dengan istihsan sama dengan menetapkan hukum berdasarkan hawa nafsu."
            },
            {
                type: "Pilihan Ganda",
                question: "Adanya persoalan-persoalan yang harus dicarikan status hukumnya, sementara di dalam nash Al-Qur'an dan As-Sunah tidak ditemukan hukumnya dan mujtahid pun belum melakukan ijma', sebagai salah satu alasan ulama melakukan....",
                options: [
                    "ijma'",
                    "ijtihad",
                    "qiyas",
                    "istishab",
                    "istihsan"
                ],
                correct: 2,
                explanation: "Qiyas dilakukan ketika tidak ditemukan hukum dalam Al-Qur'an, As-Sunnah, dan belum ada ijma' ulama tentang masalah tersebut."
            },
            {
                type: "Pilihan Ganda",
                question: "Sunah Rasulullah adalah sumber hukum Islam. Hal itu berdasarkan ....",
                options: [
                    "Q.S. an-Nisa' [4]: 59",
                    "Q.S. al-Ma'idah [5]: 90",
                    "Q.S. al-Hasyr [59]: 2",
                    "Q.S. al-Hasyr [59]: 7",
                    "Q.S. an-Nisa' [4]: 115"
                ],
                correct: 3,
                explanation: "Q.S. al-Hasyr [59]: 7 menjadi dasar bahwa Sunnah Rasulullah adalah sumber hukum Islam dengan perintah untuk mengambil apa yang diberikan Rasul."
            },
            {
                type: "Pilihan Ganda",
                question: "Menetapkan hukum suatu kejadian atau peristiwa yang tidak ada dasar nashnya dengan cara membandingkannya kepada suatu kejadian atau peristiwa yang lain yang telah ditetapkan hukumnya berdasarkan nash karena ada persamaan 'illat antara kedua kejadian atau peristiwa itu adalah pengertian dari ....",
                options: [
                    "ijma'",
                    "qiyas",
                    "ijtihad",
                    "sunah",
                    "istihsan"
                ],
                correct: 1,
                explanation: "Qiyas adalah menetapkan hukum dengan membandingkan suatu kejadian dengan kejadian lain yang sudah ada nashnya karena persamaan 'illat."
            },
            {
                type: "Pilihan Ganda",
                question: "Menurut Imam Abu Hanifah dan Imam Syafi'i, saddu adz-dzari'ah tidak dapat dijadikan sumber hukum, karena sesuatu yang menurut hukum asalnya mubah....",
                options: [
                    "dapat mendorong dan membuka perbuatan-perbuatan yang dilarang oleh agama",
                    "tetap diperlakukan sebagai yang mubah",
                    "bisa berubah menjadi sunah",
                    "bisa berubah menjadi wajib",
                    "tetap diperlakukan sebagai yang mubah"
                ],
                correct: 1,
                explanation: "Imam Abu Hanifah dan Imam Syafi'i berpendapat bahwa sesuatu yang asalnya mubah tetap diperlakukan sebagai mubah meskipun bisa membuka jalan ke yang haram."
            },
            {
                type: "Pilihan Ganda",
                question: "Menetapkan hukum karena ada persamaan dilalat al hukm (penunjukan hukumnya) disebut qiyas....",
                options: [
                    "aulawi",
                    "syibh",
                    "musawi",
                    "dilalah",
                    "murni"
                ],
                correct: 3,
                explanation: "Qiyas dilalah adalah menetapkan hukum karena ada persamaan dalam penunjukan hukumnya (dilalat al hukm)."
            },
            {
                type: "Pilihan Ganda",
                question: "Jumhur ulama berpendapat bahwa dalalat al-iqtiran... dijadikan hujjah.",
                options: [
                    "dapat",
                    "wajib",
                    "dianjurkan",
                    "ada kemungkinan",
                    "tidak dapat"
                ],
                correct: 4,
                explanation: "Jumhur ulama berpendapat bahwa dalalat al-iqtiran tidak dapat dijadikan hujjah dalam penetapan hukum Islam."
            },
            {
                type: "Isian",
                question: "Al-Qur'an merupakan sumber hukum Islam tertinggi karena merupakan wahyu Allah swt. yang berfungsi sebagai....",
                correct: "hudan",
                explanation: "Al-Qur'an berfungsi sebagai hudan (petunjuk) bagi umat manusia dalam menjalani kehidupan."
            },
            {
                type: "Isian",
                question: "Kesepakatan para ulama mujtahid pada satu masa setelah wafatnya Rasulullah saw. dalam menetapkan suatu hukum disebut....",
                correct: "ijma'",
                explanation: "Ijma' adalah kesepakatan para ulama mujtahid pada satu masa dalam menetapkan hukum setelah wafatnya Rasulullah."
            },
            {
                type: "Isian",
                question: "Dalam qiyas, hukum yang sudah ada dalam al-Qur'an dan dijadikan acuan disebut...",
                correct: "ashl",
                explanation: "Ashl adalah hukum yang sudah ada dalam nash (Al-Qur'an/Hadis) yang dijadikan acuan dalam qiyas."
            },
            {
                type: "Isian",
                question: "Maksud dari dalil qath'i adalah... pasti.",
                correct: "penunjukan",
                explanation: "Dalil qath'i adalah dalil yang penunjukannya pasti, tidak mengandung kemungkinan makna lain."
            },
            {
                type: "Isian",
                question: "Ulama yang menolak menggunakan istishab sebagai sumber hukum Islam adalah...",
                correct: "zhahiriyah",
                explanation: "Ulama mazhab Zhahiriyah menolak istishab sebagai sumber hukum karena hanya berpegang pada zahir nash."
            },
            {
                type: "Isian",
                question: "Kebiasaan masyarakat yang berkaitan dengan perbuatan disebut....",
                correct: "urf amali",
                explanation: "Urf amali adalah kebiasaan masyarakat yang berkaitan dengan perbuatan atau tindakan."
            },
            {
                type: "Isian",
                question: "Sifat atau alasan hukum yang digunakan dalam qiyas disebut....",
                correct: "illat",
                explanation: "Illat adalah sifat atau alasan hukum yang menjadi dasar persamaan antara ashl dan far' dalam qiyas."
            },
            {
                type: "Isian",
                question: "Kebiasaan masyarakat dalam mempergunakan lafadz atau ungkapan tertentu disebut....",
                correct: "urf qauli",
                explanation: "Urf qauli adalah kebiasaan masyarakat dalam menggunakan lafadz atau ungkapan tertentu."
            },
            {
                type: "Isian",
                question: "Surah an-Nahl ayat 8 dijadikan contoh hukum dalalat al-iqtiran oleh...",
                correct: "Imam Syafi'i",
                explanation: "Imam Syafi'i menggunakan Surah an-Nahl ayat 8 sebagai contoh dalalat al-iqtiran dalam menetapkan hukum."
            },
            {
                type: "Isian",
                question: "Tidak boleh bertentangan dengan maqasid syariah, dalil-dalil kulli, dan juzi yang qath'i wurud dan dalalahnya, dari nash al-Qur'an dan as-Sunnah merupakan syarat berpegang teguh kepada....",
                correct: "maslahah mursalah",
                explanation: "Syarat berpegang kepada maslahah mursalah adalah tidak boleh bertentangan dengan maqasid syariah dan dalil-dalil yang qath'i."
            },
            {
                type: "Essay",
                question: "Bagaimana proses ijma' terbentuk, dan mengapa hasil ijma' tidak boleh diingkari oleh mujtahid generasi berikutnya?",
                correct: "Proses ijma' terbentuk melalui kesepakatan seluruh mujtahid pada satu masa terhadap suatu hukum. Hasil ijma' tidak boleh diingkari karena dianggap sebagai hujjah qath'i yang mengikat dan mencerminkan kehendak Allah melalui konsensus ulama.",
                explanation: "Ijma' terbentuk ketika seluruh mujtahid pada satu masa sepakat tentang suatu hukum. Hasilnya tidak dapat diingkari karena dianggap sebagai dalil qath'i yang mengikat semua generasi setelahnya."
            },
            {
                type: "Essay",
                question: "Sebutkan minimal tiga syarat penting yang harus dimiliki seorang mujtahid menurut para ulama ushul fikih!",
                correct: "Tiga syarat penting mujtahid: 1) Menguasai bahasa Arab dengan baik, 2) Menguasai ilmu ushul fikih, 3) Mengetahui nash-nash Al-Qur'an dan Hadis yang berkaitan dengan hukum, 4) Mengetahui ijma' yang telah ada sebelumnya, 5) Memahami maqasid syariah.",
                explanation: "Seorang mujtahid harus memiliki syarat-syarat khusus agar mampu melakukan ijtihad dengan benar dan menghasilkan hukum yang sesuai dengan syariat Islam."
            },
            {
                type: "Essay",
                question: "Jelaskan perbedaan antara ijma' sahabat dan ijma' sukuti dari segi pelaksanaannya dan penerimaannya oleh ulama!",
                correct: "Ijma' sahabat adalah kesepakatan para sahabat secara eksplisit, sedangkan ijma' sukuti adalah kesepakatan melalui diam (tidak ada yang menentang). Ijma' sahabat lebih kuat kedudukannya karena eksplisit, sementara ijma' sukuti masih diperdebatkan kehujjahannya oleh sebagian ulama.",
                explanation: "Perbedaan utama terletak pada cara penyampaian kesepakatan dan tingkat penerimaan di kalangan ulama. Ijma' sahabat lebih jelas dan diterima secara luas."
            },
            {
                type: "Essay",
                question: "Bagaimana kehujjahan dari hadis?",
                correct: "Kehujjahan hadis bergantung pada kualitas sanad dan matan. Hadis sahih memiliki kehujjahan yang kuat, hadis hasan memiliki kehujjahan yang dapat diterima, sedangkan hadis dhaif tidak dapat dijadikan hujjah dalam menetapkan hukum. Hadis mutawatir memiliki kehujjahan qath'i, sedangkan hadis ahad memiliki kehujjahan zhanni.",
                explanation: "Kehujjahan hadis ditentukan oleh tingkat keshahihan dan cara periwayatannya. Semakin sahih hadis, semakin kuat kehujjahannya dalam penetapan hukum Islam."
            },
            {
                type: "Essay",
                question: "Apa maksud asas at-tadriju fit tasyri'?",
                correct: "At-tadriju fit tasyri' adalah asas berangsur-angsur dalam penetapan hukum Islam. Maksudnya adalah Allah menurunkan hukum-hukum Islam secara bertahap sesuai dengan kondisi dan kesiapan masyarakat, seperti pengharaman khamr yang dilakukan dalam beberapa tahap.",
                explanation: "Asas ini menunjukkan hikmah Allah dalam menurunkan syariat secara bertahap agar mudah diterima dan dilaksanakan oleh umat manusia."
            },
            {
                type: "Essay",
                question: "Jelaskan pengertian ijma' secara istilah!",
                correct: "Ijma' secara istilah adalah kesepakatan seluruh mujtahid pada suatu masa setelah wafatnya Rasulullah SAW terhadap suatu hukum syara' mengenai suatu peristiwa atau masalah tertentu. Ijma' merupakan sumber hukum Islam ketiga setelah Al-Qur'an dan As-Sunnah.",
                explanation: "Ijma' adalah konsensus ulama mujtahid yang menjadi salah satu sumber hukum Islam yang penting dan mengikat."
            },
            {
                type: "Essay",
                question: "Apakah yang dimaksud dengan syar'u man qablana?",
                correct: "Syar'u man qablana adalah syariat atau hukum-hukum yang berlaku pada umat-umat terdahulu sebelum Islam, seperti syariat Nabi Musa dan Nabi Isa. Para ulama berbeda pendapat tentang kehujjahannya bagi umat Islam, ada yang menerima dan ada yang menolaknya sebagai sumber hukum.",
                explanation: "Syar'u man qablana merujuk pada hukum-hukum agama samawi sebelum Islam yang masih diperdebatkan kehujjahannya bagi umat Islam."
            },
            {
                type: "Essay",
                question: "Jelaskan tiga fungsi utama qiyas dalam pembentukan hukum Islam!",
                correct: "Tiga fungsi utama qiyas: 1) Menetapkan hukum bagi masalah-masalah baru yang tidak ada nashnya dengan menganalogikan kepada masalah yang sudah ada nashnya, 2) Memperluas cakupan hukum Islam agar dapat menjawab perkembangan zaman, 3) Memelihara konsistensi dan keselarasan hukum Islam berdasarkan 'illat yang sama.",
                explanation: "Qiyas berfungsi sebagai metode penetapan hukum yang memungkinkan syariat Islam tetap relevan dengan perkembangan zaman sambil mempertahankan prinsip-prinsip dasarnya."
            },
            {
                type: "Essay",
                question: "Mengapa Imam Syaukani berpendapat bahwa qaulu shahabi tidak dapat dijadikan hujjah?",
                correct: "Imam Syaukani berpendapat qaulu shahabi tidak dapat dijadikan hujjah karena: 1) Sahabat bukan maksum (tidak terbebas dari kesalahan), 2) Pendapat sahabat adalah hasil ijtihad manusia yang bisa salah, 3) Tidak ada dalil qath'i yang mewajibkan mengikuti pendapat sahabat, 4) Hanya Al-Qur'an dan Hadis sahih yang wajib diikuti.",
                explanation: "Imam Syaukani menolak qaulu shahabi sebagai hujjah karena menganggap hanya nash Al-Qur'an dan Hadis sahih yang memiliki otoritas mutlak dalam penetapan hukum."
            },
            {
                type: "Essay",
                question: "Sebutkan pokok-pokok kandungan al-Qur'an!",
                correct: "Pokok-pokok kandungan Al-Qur'an meliputi: 1) Akidah (keimanan kepada Allah, malaikat, kitab, rasul, hari akhir, qada dan qadar), 2) Syariah (hukum-hukum ibadah, muamalah, jinayah, dan ahwal syakhsiyyah), 3) Akhlak (budi pekerti yang baik dalam hubungan dengan Allah, sesama manusia, dan alam), 4) Kisah-kisah umat terdahulu sebagai pelajaran, 5) Janji dan ancaman (surga dan neraka).",
                explanation: "Al-Qur'an mengandung ajaran komprehensif yang mencakup seluruh aspek kehidupan manusia, baik hubungan vertikal dengan Allah maupun horizontal dengan sesama makhluk."
            },
            {
                type: "Remedial",
                question: "Ijma' yang terjadi karena tidak adanya penolakan dari mujtahid lain terhadap pendapat mujtahid pada masanya disebut....",
                correct: "ijma' sukuti",
                explanation: "Ijma' sukuti adalah kesepakatan yang terjadi melalui diam atau tidak adanya penolakan dari mujtahid lain terhadap suatu pendapat."
            },
            {
                type: "Remedial",
                question: "Salah satu syarat utama seorang mujtahid adalah menguasai ilmu....",
                correct: "ushul fiqih",
                explanation: "Menguasai ilmu ushul fiqih adalah syarat utama seorang mujtahid untuk dapat melakukan ijtihad dengan benar."
            },
            {
                type: "Remedial",
                question: "Qiyas yang illat pada hukum cabangnya lebih kuat dibanding hukum asalnya disebut....",
                correct: "qiyas aulawi",
                explanation: "Qiyas aulawi adalah analogi yang hukum cabangnya lebih kuat atau lebih utama dibandingkan hukum asalnya."
            },
            {
                type: "Remedial",
                question: "Para sahabat seperti Abu Bakar dan Umar menunjukkan sikap berhati-hati dalam menetapkan hukum dengan selalu merujuk pada....",
                correct: "Al-Qur'an dan Hadis",
                explanation: "Para sahabat selalu berhati-hati dalam menetapkan hukum dengan merujuk pada Al-Qur'an dan Hadis sebagai sumber utama."
            },
            {
                type: "Remedial",
                question: "Dalam qiyas, objek atau kasus baru yang tidak memiliki nash hukum disebut dengan istilah....",
                correct: "far'",
                explanation: "Far' adalah objek atau kasus baru yang tidak memiliki nash hukum dan akan diqiyaskan dengan ashl yang sudah ada nashnya."
            },
            {
                type: "Pengayaan",
                question: "Jelaskan secara singkat pengertian dan contoh dari qiyas jalli dan qiyas khafi!",
                correct: "Qiyas jalli adalah analogi yang 'illatnya jelas dan mudah dipahami, seperti mengqiyaskan nabidz (minuman fermentasi) dengan khamr karena sama-sama memabukkan. Qiyas khafi adalah analogi yang 'illatnya samar dan memerlukan penelitian mendalam, seperti mengqiyaskan jual beli salam dengan jual beli biasa dalam hal keabsahan.",
                explanation: "Qiyas jalli memiliki 'illat yang jelas dan mudah dipahami, sedangkan qiyas khafi memiliki 'illat yang samar dan memerlukan penelitian mendalam untuk menemukannya."
            },
            {
                type: "Pengayaan",
                question: "Sebutkan dan jelaskan dua macam ijma' ditinjau dari bentuk ekspresi kesepakatannya!",
                correct: "1) Ijma' Qawli (ijma' perkataan): kesepakatan yang dinyatakan secara eksplisit melalui perkataan atau tulisan oleh para mujtahid. 2) Ijma' Sukuti (ijma' diam): kesepakatan yang terjadi ketika sebagian mujtahid menyatakan pendapat dan mujtahid lainnya diam atau tidak menentang, sehingga dianggap setuju.",
                explanation: "Ijma' dapat terbentuk melalui pernyataan eksplisit (qawli) atau melalui sikap diam yang menunjukkan persetujuan (sukuti)."
            },
            {
                type: "Pengayaan",
                question: "Jelaskan makna dari qiyas musawi!",
                correct: "Qiyas musawi adalah analogi yang kekuatan 'illat pada hukum cabang (far') sama dengan kekuatan 'illat pada hukum asal (ashl). Contohnya mengqiyaskan emas dengan perak dalam hal kewajiban zakat, karena keduanya sama-sama logam mulia yang berharga dan dapat dijadikan alat tukar.",
                explanation: "Qiyas musawi menunjukkan kesetaraan kekuatan 'illat antara ashl dan far', sehingga hukum yang dihasilkan memiliki kekuatan yang sama."
            },
            {
                type: "Pengayaan",
                question: "Apa perbedaan antara ijma' qath'i dan ijma' dzanni?",
                correct: "Ijma' qath'i adalah kesepakatan yang pasti dan tidak dapat dibantah lagi, biasanya terjadi pada masalah-masalah pokok agama yang sudah jelas. Ijma' dzanni adalah kesepakatan yang masih mengandung kemungkinan salah, biasanya terjadi pada masalah-masalah furu'iyyah (cabang) yang memerlukan ijtihad lebih lanjut.",
                explanation: "Perbedaan terletak pada tingkat kepastian dan kemungkinan adanya kesalahan dalam kesepakatan yang dicapai oleh para mujtahid."
            },
            {
                type: "Pengayaan",
                question: "Apa peran maqasid al-syari'ah dalam ijtihad?",
                correct: "Maqasid al-syari'ah berperan sebagai pedoman dan tujuan dalam melakukan ijtihad. Setiap hasil ijtihad harus sejalan dengan lima tujuan pokok syariat: memelihara agama (hifz al-din), jiwa (hifz al-nafs), akal (hifz al-aql), keturunan (hifz al-nasl), dan harta (hifz al-mal). Maqasid juga membantu mujtahid dalam menentukan prioritas dan memilih pendapat yang paling maslahat.",
                explanation: "Maqasid al-syari'ah menjadi kompas dalam ijtihad untuk memastikan bahwa hukum yang dihasilkan sesuai dengan tujuan-tujuan pokok syariat Islam."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answers = [];
        let studentData = {};

        // Subject chapters data - simplified to just chapter numbers
        const subjectChapters = {
            "Fisika": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Kimia": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Biologi": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Matematika": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Bahasa Indonesia": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Bahasa Inggris": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Sejarah": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Geografi": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Ekonomi": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Sosiologi": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Quran Hadist": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Fikih": [
                "Bab 1 - Pengantar Ushul Fiqih", "Bab 2 - Sumber Hukum Islam", "Bab 3 - Al-Qur'an sebagai Sumber Hukum", "Bab 4 - As-Sunnah sebagai Sumber Hukum", "Bab 5 - Ijma' dan Qiyas",
                "Bab 6 - Istihsan dan Istishab", "Bab 7 - Maslahah Mursalah", "Bab 8 - Urf dan Adat", "Bab 9 - Syar'u Man Qablana", "Bab 10 - Sadd az-Dzari'ah",
                "Bab 11 - Hukum Taklifi", "Bab 12 - Hukum Wad'i", "Bab 13 - Mukallaf dan Syarat-syaratnya", "Bab 14 - Azimah dan Rukhsah", "Bab 15 - Ta'arud al-Adillah",
                "Bab 16 - Tarjih", "Bab 17 - Naskh", "Bab 18 - Ijtihad dan Taqlid", "Bab 19 - Fatwa", "Bab 20 - Mazhab Fiqih"
            ],
            "Akidah Akhlaq": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ],
            "Sejarah Kebudayaan Islam": [
                "Bab 1", "Bab 2", "Bab 3", "Bab 4", "Bab 5",
                "Bab 6", "Bab 7", "Bab 8", "Bab 9", "Bab 10",
                "Bab 11", "Bab 12", "Bab 13", "Bab 14", "Bab 15",
                "Bab 16", "Bab 17", "Bab 18", "Bab 19", "Bab 20"
            ]
        };

        function updateChapters() {
            const subject = document.getElementById('subjectName').value;
            const chapterSelect = document.getElementById('chapterName');
            
            chapterSelect.innerHTML = '<option value="">Pilih Bab</option>';
            
            if (subject && subjectChapters[subject]) {
                chapterSelect.disabled = false;
                subjectChapters[subject].forEach(chapter => {
                    chapterSelect.innerHTML += `<option value="${chapter}">${chapter}</option>`;
                });
            } else {
                chapterSelect.disabled = true;
                chapterSelect.innerHTML = '<option value="">Pilih mata pelajaran terlebih dahulu</option>';
            }
        }

        function startQuiz() {
            const name = document.getElementById('studentName').value.trim();
            const studentClass = document.getElementById('studentClass').value;
            const subject = document.getElementById('subjectName').value;
            const chapter = document.getElementById('chapterName').value;

            if (!name || !studentClass || !subject || !chapter) {
                alert('Mohon lengkapi semua data siswa terlebih dahulu!');
                return;
            }

            studentData = { name, class: studentClass, subject, chapter };
            
            document.getElementById('studentForm').classList.add('hidden');
            document.getElementById('quizContainer').classList.remove('hidden');
            
            showQuestion();
        }

        function showQuestion() {
            const question = quizData[currentQuestion];
            
            document.getElementById('questionNumber').textContent = `Soal ${currentQuestion + 1}`;
            document.getElementById('questionType').textContent = question.type;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('progressText').textContent = `${currentQuestion + 1} / ${quizData.length}`;
            document.getElementById('progressBar').style.width = `${((currentQuestion + 1) / quizData.length) * 100}%`;

            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';

            if (question.type === "Pilihan Ganda" || question.type === "Remedial" || question.type === "Pengayaan") {
                question.options.forEach((option, index) => {
                    optionsContainer.innerHTML += `
                        <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition duration-200">
                            <input type="radio" name="answer" value="${index}" class="mr-3 text-indigo-600">
                            <span class="text-gray-700">${String.fromCharCode(65 + index)}. ${option}</span>
                        </label>
                    `;
                });
            } else if (question.type === "Isian") {
                optionsContainer.innerHTML = `
                    <input type="text" id="fillAnswer" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="Masukkan jawaban Anda...">
                `;
            } else if (question.type === "Essay") {
                optionsContainer.innerHTML = `
                    <textarea id="essayAnswer" rows="6" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none" placeholder="Tulis jawaban essay Anda di sini... (minimal 50 kata)"></textarea>
                    <div class="text-sm text-gray-500 mt-2">Jumlah kata: <span id="wordCount">0</span></div>
                `;
                
                document.getElementById('essayAnswer').addEventListener('input', function() {
                    const words = this.value.trim().split(/\s+/).filter(word => word.length > 0);
                    document.getElementById('wordCount').textContent = words.length;
                });
            }

            document.getElementById('questionCard').classList.add('fade-in');
        }

        function checkAnswer() {
            const question = quizData[currentQuestion];
            let userAnswer = null;
            let isCorrect = false;

            if (question.type === "Pilihan Ganda" || question.type === "Remedial" || question.type === "Pengayaan") {
                const selected = document.querySelector('input[name="answer"]:checked');
                if (!selected) {
                    alert('Pilih salah satu jawaban terlebih dahulu!');
                    return;
                }
                userAnswer = parseInt(selected.value);
                isCorrect = userAnswer === question.correct;
                
                // Show answer with zoom effect for multiple choice
                showMultipleChoiceAnswer(userAnswer, question.correct);
                
            } else if (question.type === "Isian") {
                userAnswer = document.getElementById('fillAnswer').value.trim();
                if (!userAnswer) {
                    alert('Masukkan jawaban terlebih dahulu!');
                    return;
                }
                isCorrect = userAnswer.toLowerCase() === question.correct.toLowerCase();
                
                // Show answer with zoom effect for fill-in-the-blank
                showTextAnswer(userAnswer, question.correct, isCorrect);
                
            } else if (question.type === "Essay") {
                userAnswer = document.getElementById('essayAnswer').value.trim();
                const wordCount = userAnswer.split(/\s+/).filter(word => word.length > 0).length;
                if (wordCount < 50) {
                    alert('Jawaban essay harus minimal 50 kata!');
                    return;
                }
                // For essay, we'll mark as correct if it has sufficient words (in real scenario, manual grading needed)
                isCorrect = wordCount >= 50;
                
                // Show answer with zoom effect for essay
                showEssayAnswer(userAnswer, question.correct, isCorrect);
            }

            answers.push({
                question: question.question,
                userAnswer: userAnswer,
                correct: isCorrect,
                explanation: question.explanation
            });

            if (isCorrect) {
                score++;
            }

            // Disable submit button and show feedback after delay
            document.getElementById('submitAnswer').disabled = true;
            setTimeout(() => {
                showFeedback(isCorrect, question.explanation);
            }, 1500);
        }

        function showMultipleChoiceAnswer(userAnswer, correctAnswer) {
            const labels = document.querySelectorAll('label');
            
            labels.forEach((label, index) => {
                const input = label.querySelector('input');
                input.disabled = true;
                
                if (index === correctAnswer) {
                    label.classList.add('correct-answer');
                } else if (index === userAnswer && userAnswer !== correctAnswer) {
                    label.classList.add('wrong-answer');
                }
            });
            
            // Show correct answer explanation
            const optionsContainer = document.getElementById('answerOptions');
            const answerReveal = document.createElement('div');
            answerReveal.className = 'answer-reveal';
            answerReveal.innerHTML = `
                <div class="flex items-center mb-2">
                    <span class="text-2xl mr-2">‚úÖ</span>
                    <strong>Jawaban Benar: ${String.fromCharCode(65 + correctAnswer)}</strong>
                </div>
                <p class="text-sm opacity-90">${quizData[currentQuestion].options[correctAnswer]}</p>
            `;
            optionsContainer.appendChild(answerReveal);
        }

        function showTextAnswer(userAnswer, correctAnswer, isCorrect) {
            const inputElement = document.getElementById('fillAnswer') || document.getElementById('essayAnswer');
            inputElement.disabled = true;
            
            if (isCorrect) {
                inputElement.classList.add('correct-text-answer');
            } else {
                inputElement.classList.add('wrong-text-answer');
            }
            
            // Show correct answer explanation
            const optionsContainer = document.getElementById('answerOptions');
            const answerReveal = document.createElement('div');
            answerReveal.className = 'answer-reveal';
            answerReveal.innerHTML = `
                <div class="flex items-center mb-2">
                    <span class="text-2xl mr-2">${isCorrect ? '‚úÖ' : '‚ùå'}</span>
                    <strong>${isCorrect ? 'Jawaban Anda Benar!' : 'Jawaban Benar:'}</strong>
                </div>
                ${!isCorrect ? `<p class="text-sm opacity-90 mb-2"><strong>Jawaban yang benar:</strong> ${correctAnswer}</p>` : ''}
                <p class="text-sm opacity-90"><strong>Jawaban Anda:</strong> ${userAnswer}</p>
            `;
            optionsContainer.appendChild(answerReveal);
        }

        function showEssayAnswer(userAnswer, correctAnswer, isCorrect) {
            const textareaElement = document.getElementById('essayAnswer');
            textareaElement.disabled = true;
            
            if (isCorrect) {
                textareaElement.classList.add('correct-text-answer');
            } else {
                textareaElement.classList.add('wrong-text-answer');
            }
            
            // Show model answer for essay
            const optionsContainer = document.getElementById('answerOptions');
            const answerReveal = document.createElement('div');
            answerReveal.className = 'answer-reveal';
            answerReveal.innerHTML = `
                <div class="flex items-center mb-3">
                    <span class="text-2xl mr-2">üìù</span>
                    <strong>Contoh Jawaban yang Baik:</strong>
                </div>
                <div class="bg-white bg-opacity-20 p-3 rounded-lg text-sm">
                    ${correctAnswer}
                </div>
                <div class="mt-3 text-sm opacity-90">
                    <strong>Status:</strong> ${isCorrect ? '‚úÖ Jawaban Anda memenuhi kriteria (minimal 50 kata)' : '‚ùå Jawaban Anda kurang memenuhi kriteria'}
                </div>
            `;
            optionsContainer.appendChild(answerReveal);
        }

        function showFeedback(isCorrect, explanation) {
            const modal = document.getElementById('feedbackModal');
            const icon = document.getElementById('feedbackIcon');
            const title = document.getElementById('feedbackTitle');
            const message = document.getElementById('feedbackMessage');

            if (isCorrect) {
                icon.textContent = 'üëè';
                title.textContent = 'Benar!';
                title.className = 'text-2xl font-bold mb-2 text-green-600';
                message.textContent = explanation;
                document.getElementById('questionCard').classList.add('celebration');
            } else {
                icon.textContent = 'üò¢';
                title.textContent = 'Kurang Tepat';
                title.className = 'text-2xl font-bold mb-2 text-red-600';
                message.textContent = explanation;
                document.getElementById('questionCard').classList.add('sad-shake');
            }

            modal.classList.remove('hidden');
        }

        function nextQuestion() {
            document.getElementById('feedbackModal').classList.add('hidden');
            document.getElementById('questionCard').classList.remove('celebration', 'sad-shake', 'fade-in');
            
            // Reset submit button
            document.getElementById('submitAnswer').disabled = false;
            
            currentQuestion++;
            
            if (currentQuestion < quizData.length) {
                setTimeout(() => {
                    showQuestion();
                }, 300);
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quizContainer').classList.add('hidden');
            document.getElementById('resultsContainer').classList.remove('hidden');
            
            document.getElementById('finalScore').textContent = `${score}/${quizData.length}`;
            document.getElementById('correctCount').textContent = score;
            document.getElementById('wrongCount').textContent = quizData.length - score;
        }

        function submitToGoogleSheets() {
            // Demo implementation - in real scenario, you would need to set up Google Apps Script
            const resultData = {
                timestamp: new Date().toLocaleString('id-ID'),
                nama: studentData.name,
                kelas: studentData.class,
                mata_pelajaran: studentData.subject,
                bab: studentData.chapter,
                skor: score,
                total: quizData.length,
                persentase: Math.round((score / quizData.length) * 100),
                detail_jawaban: answers
            };

            // This is a demo alert - replace with actual Google Sheets API call
            alert(`Data berhasil disiapkan untuk dikirim ke Google Sheets!\n\nRingkasan:\nNama: ${resultData.nama}\nKelas: ${resultData.kelas}\nMata Pelajaran: ${resultData.mata_pelajaran}\nBab: ${resultData.bab}\nSkor: ${resultData.skor}/${resultData.total} (${resultData.persentase}%)\n\nCatatan: Untuk implementasi nyata, Anda perlu mengatur Google Apps Script dan mengganti fungsi ini dengan API call yang sebenarnya.`);
            
            console.log('Data untuk Google Sheets:', resultData);
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            answers = [];
            studentData = {};
            
            document.getElementById('resultsContainer').classList.add('hidden');
            document.getElementById('studentForm').classList.remove('hidden');
            
            // Reset form
            document.getElementById('studentName').value = '';
            document.getElementById('studentClass').value = '';
            document.getElementById('subjectName').value = '';
            document.getElementById('chapterName').value = '';
            document.getElementById('chapterName').disabled = true;
            document.getElementById('chapterName').innerHTML = '<option value="">Pilih mata pelajaran terlebih dahulu</option>';
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97fd6633e4b2fd1c',t:'MTc1Nzk5NDYyMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
